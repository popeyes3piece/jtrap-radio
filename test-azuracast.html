<!DOCTYPE html>
<html>
<head>
    <title>AzuraCast API Test</title>
    <style>
        body { font-family: monospace; margin: 20px; }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
        pre { background: #f0f0f0; padding: 10px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>AzuraCast API Test</h1>
    <p>This page tests direct connection to your AzuraCast server.</p>
    
    <div id="results"></div>
    
    <script>
        async function testAzuraCast() {
            const results = document.getElementById('results');
            results.innerHTML = '<p class="info">Testing AzuraCast connection...</p>';
            
            const baseUrls = ["http://10.0.0.36", "https://10.0.0.36"];
            const endpoints = [
                '/api',
                '/api/stations',
                '/api/nowplaying',
                '/api/nowplaying/1',
                '/api/nowplaying/jtrap_radio',
                '/api/nowplaying/jtrap',
                '/api/nowplaying/radio',
                // Try the correct AzuraCast API structure
                '/api/station/1/nowplaying',
                '/api/station/jtrap_radio/nowplaying',
                '/api/station/1/requests',
                '/api/station/jtrap_radio/requests'
            ];
            
            for (const baseUrl of baseUrls) {
                results.innerHTML += `<h2>Testing ${baseUrl}</h2>`;
                
                for (const endpoint of endpoints) {
                    try {
                        const url = `${baseUrl}${endpoint}`;
                        results.innerHTML += `<p>Testing: <a href="${url}" target="_blank">${url}</a></p>`;
                        
                        const response = await fetch(url);
                        results.innerHTML += `<p>Status: ${response.status} ${response.statusText}</p>`;
                        
                        if (response.ok) {
                            const data = await response.json();
                            results.innerHTML += `<p class="success">‚úÖ SUCCESS!</p>`;
                            results.innerHTML += `<pre>${JSON.stringify(data, null, 2)}</pre>`;
                            
                            if (endpoint === '/api/stations' && Array.isArray(data)) {
                                results.innerHTML += `<p class="info">üìª Available stations: ${data.map(s => s.shortcode || s.name || s.id).join(', ')}</p>`;
                            }
                        } else {
                            results.innerHTML += `<p class="error">‚ùå Failed: ${response.status} ${response.statusText}</p>`;
                        }
                    } catch (error) {
                        results.innerHTML += `<p class="error">‚ùå Error: ${error.message}</p>`;
                    }
                    
                    results.innerHTML += '<hr>';
                }
            }
            
            results.innerHTML += '<p class="info">Test complete!</p>';
        }
        
        // Run test when page loads
        testAzuraCast();
    </script>
</body>
</html>
